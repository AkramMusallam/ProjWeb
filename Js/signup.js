const signupForm = document.getElementById('signup-form');

window.addEventListener('DOMContentLoaded', () => {
    signupForm.addEventListener('submit', handleSignup);
    addPasswordToggle();
});

function handleSignup(e) {
    e.preventDefault();

    const username = document.getElementById('username').value.trim();
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value.trim();

    if (username.length < 3) {
        showNotification('Username must be at least 3 characters', 'error');
        return;
    }
    if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
        showNotification('Please enter a valid email', 'error');
        return;
    }
    if (password.length < 6) {
        showNotification('Password must be at least 6 characters', 'error');
        return;
    }

    let users = JSON.parse(localStorage.getItem('users')) || [];

    if (users.some(u => u.email === email)) {
        showNotification('This email is already registered!', 'error');
        return;
    }

    users.push({ username, email, password });
    localStorage.setItem('users', JSON.stringify(users));

    showNotification('Account created successfully!', 'success');
    setTimeout(() => { window.location.href = 'login.html'; }, 1500);
}

function addPasswordToggle() {
    const pwd = document.getElementById('password');
    const btn = document.createElement('button');
    btn.type = 'button';
    btn.textContent = 'ğŸ‘ï¸';
    btn.style.cssText = 'position:absolute;right:10px;top:50%;transform:translateY(-50%);background:none;border:none;font-size:18px;cursor:pointer;opacity:0.6;';
    btn.addEventListener('click', () => {
        pwd.type = pwd.type === 'password' ? 'text' : 'password';
        btn.textContent = pwd.type === 'password' ? 'ğŸ‘ï¸' : 'ğŸ™ˆ';
    });
    pwd.parentElement.style.position = 'relative';
    pwd.parentElement.appendChild(btn);
}
